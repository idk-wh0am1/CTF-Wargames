from pwn import *
from PIL import Image
from Crypto.Random import get_random_bytes
from io import BytesIO
from base64 import b64encode, b64decode


# io = remote("challs.dantectf.it", 31511)
# io = process(["python", "PiedPic.py"])

# io.sendline(b"y")
# io.recvuntil(b"My picture:\n\n")

# # get enc_flag
# enc_flag = b64decode(io.recvall(timeout=5).decode().split("Your picture:")[0].strip())
# print(len(enc_flag), enc_flag[-20:], len(enc_flag)/3)
# # io.interactive()

from socket import socket
from telnetlib import Telnet

sock = socket()
sock.connect(('challs.dantectf.it', 31511))
print(sock.recv(1024))
sock.send(b'y\n')

def recvuntil(sock,delim = b'\n') :
    data = b""
    while not data.endswith(delim):
        data += sock.recv(1)
    return data

print(recvuntil(sock, b'\n\n'))
data = b64decode(recvuntil(sock, b'\n\n').decode())
print(len(data), len(data)/3)