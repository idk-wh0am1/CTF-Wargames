from pwn import *
from Crypto.Util.number import *

io = remote("matrixrsa.chal.crewc.tf", 20001)

# [a, m] [a, m]  [a^2, 2am] [a, m] [a^3, 3a^2m]
# [0, a] [0, a]  [0  , a^2] [0, a] [0  , a^3]

# [a^e, e*m*a^(e - 1)]
# [0  , a^e]

io.recvuntil(b"flag(enc_0, enc_1):\n")
c0 = int(io.recvline().decode().strip(), 16)
c1 = int(io.recvline().decode().strip(), 16)

io.sendlineafter(b">> ", hex(c0)[2:].encode())
io.sendlineafter(b">> ", hex(2*c1)[2:].encode())

io.recvuntil(b"decrypted message:\n")
m = int(io.recvline().decode().strip(), 16)

print(long_to_bytes(m//2))