from pwn import *
from Crypto.Util.number import *

io = remote("tjc.tf", 31358)

n = int(io.recvline())
user = b"admin"

io.sendlineafter(b"Cmd: ", b"new")
io.sendlineafter(b"Name: ", long_to_bytes(bytes_to_long(user) + n))
sig = int(io.recvline().split()[-1])

io.sendlineafter(b"Cmd: ", b"login")
io.sendlineafter(b"Name: ", b"admin")
io.sendlineafter(b"Sign: ", str(sig).encode())

io.interactive()