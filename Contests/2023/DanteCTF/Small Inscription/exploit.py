from sage.all import *
from Crypto.Util.number import *

ct = 747861028284745583986165203504322648396510749839398405070811323707600711491863944680330526354962376022146478962637944671170833980881833864618493670661754856280282476606632288562133960228178540799118953209069757642578754327847269832940273765635707176669208611276095564465950147643941533690293945372328223742576232667549253123094054598941291288949397775419176103429124455420699502573739842580940268711628697334920678442711510187864949808113210697096786732976916002133678253353848775265650016864896187184151924272716863071499925744529203583206734774883138969347565787210674308042083803787880001925683349235960512445949
N  = 20948184905072216948549865445605798631663501453911333956435737119029531982149517142273321144075961800694876109056203145122426451759388059831044529163118093342195028080582365702020138256379699270302368673086923715628087508705525518656689253472590622223905341942685751355443776992006890500774938631896675247850244098414397183590972496171655304801215957299268404242039713841456437577844606152809639584428764129318729971500384064454823140992681760685982999247885351122505154646928804561614506313946302901152432476414517575301827992421830229939161942896560958118364164451179787855749084154517490249401036072261469298158281
e  = 3

Px = PolynomialRing(Zmod(N), "x"); x = Px.gen()
k = bytes_to_long(b'There is something reeeally important you should know, the flag is ')

for len_flag in range(15 , 30):
    fx = (k*256**len_flag + x)**e - ct
    roots = fx.small_roots(X=256**len_flag, beta=0.5, epsilon=1/32)
    
    if roots:
        print(long_to_bytes(ZZ(roots[0])))