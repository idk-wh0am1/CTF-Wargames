from sage.all import *
from pwn import *
from json import *
from gmpy2 import iroot
from Crypto.Util.number import long_to_bytes

def get_data(io: remote):
    io.sendlineafter(b'(Y/n) ', b'y')
    dat = loads(io.recvline())
    return int(dat['time_capsule'], 16), int(dat['pubkey'][0], 16)

HOST = "165.227.232.214"
PORT = 31126

io = remote(HOST, PORT)
c1, n1 = get_data(io)
c2, n2 = get_data(io)
c3, n3 = get_data(io)
io.close()

e = 5
N = n1*n2*n3
C = crt([c1, c2, c3], [n1, n2, n3])

m, ok = iroot(C, e)
assert ok

flag = long_to_bytes(ZZ(m))
print(flag)