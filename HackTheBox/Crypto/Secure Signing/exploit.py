from pwn import *
from hashlib import sha256

def _hash(io: remote, l):
    # return sha256(xor( b'\x00'*l, FLAG )).hexdigest()

    io.sendlineafter(b'> ', b'1')
    io.sendlineafter(b': ', b'\x00'*l)
    io.recvuntil(b"Hash: ")
    return io.recvline().decode().strip()

def attack(io: remote, debug=False):
    flag = b""
    while not flag.endswith(b"}"):
        # just brute printable characters
        for b in range(32, 127):
            _flag = flag + bytes([b])
            if sha256(_flag).hexdigest() == _hash(io, len(_flag)):
                flag = _flag
                
                if debug:
                    print("[DEBUG] Flag: " + str(flag))
                break
    
    return flag

if __name__ == '__main__':
    io = remote("206.189.120.31", 31480)
    flag = attack(io, debug=True)