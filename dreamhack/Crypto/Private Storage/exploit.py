from pwn import *
from zlib import decompress, compress
from base64 import b64decode

def download(filename: bytes):
    io.sendlineafter(b'>> ', b'2')
    io.sendlineafter(b'>> ', filename)
    io.recvuntil(b'Content : ')
    return b64decode(io.recvline().strip().decode())

def add(filename: bytes, content: bytes):
    io.sendlineafter(b'>> ', b'3')
    io.sendlineafter(b'>> ', filename)
    io.sendlineafter(b'>> ', content)
    

io = remote("host3.dreamhack.games", 9138)

flag_compress_enc = download(b'flag.txt')

add(b'hehe.txt', b'a'*7000)
a_compress_enc = download(b'hehe.txt')
key = xor(a_compress_enc, compress(b'a'*7000))

flag = decompress(xor(flag_compress_enc, key))
print(flag)