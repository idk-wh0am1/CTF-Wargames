from pwn import *
from base64 import *


io = remote("host3.dreamhack.games", 22822)

io.recvuntil(b'test Command: ')
test_cmd_enc = b64decode(io.recvline().strip().decode())

io.sendlineafter(b'IV...: ', b64encode(test_cmd_enc[-32:-16]))
io.sendlineafter(b'Message...: ', b64encode(b'show'))
io.recvuntil(b'Ciphertext:')

show_enc = b64decode(io.recvline().strip().decode())
show_cmd_enc = test_cmd_enc[:-16] + show_enc[16:]

io.sendlineafter(b'Enter your command: ', b64encode(show_cmd_enc))
io.interactive()