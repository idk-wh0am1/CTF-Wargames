from pwn import *
from Crypto.Util.number import *

def get_info():
    io.sendline(b'3')
    io.recvuntil(b'N: '); N = int(io.recvline())
    io.recvuntil(b'e: '); e = int(io.recvline())
    io.recvuntil(b'FLAG: '); c = int(io.recvline())
    return N, e, c

def encrypt(m: bytes):
    io.sendline(b'1')
    io.sendlineafter(b'(hex): ', m.hex().encode())
    return int(io.recvline())

def decrypt(c: bytes):
    io.sendline(b'2')
    io.sendlineafter(b'(hex): ', c.hex().encode())
    return int(io.recvline())

io = remote("host3.dreamhack.games", 8192)

N, e, c = get_info()
_2m = decrypt(long_to_bytes(pow(2, e, N) * c % N))
m = _2m//2

flag = long_to_bytes(m)
print(flag)