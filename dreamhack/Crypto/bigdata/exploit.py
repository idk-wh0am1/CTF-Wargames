from pwn import *
from Crypto.Cipher import AES

io = remote("host3.dreamhack.games", 10157)
io.recvuntil(b'enc_flag = ')

key = 0
data_num = 1000000
ct = bytes.fromhex(io.recvline().strip().decode())

for i in range(data_num):
    info(str(i))
    io.sendlineafter(b'> ', str(i).encode())
    key ^= int(io.recvline())

io.close()

cipher = AES.new(key.to_bytes(16, "big"), AES.MODE_ECB)
flag = cipher.decrypt(ct)
print(flag)