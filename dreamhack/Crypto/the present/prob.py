from Crypto.Util.number import *

flag = bytes_to_long(b'DH{?????????????????????????????????????????????}')

class PRNG():
    def __init__(self, seed):
        self.seed = seed
        self.M = getStrongPrime(512)
    
    def next(self):
        self.seed = self.seed ** 2 % self.M
        return self.seed
    
    

prng = PRNG(flag)

prng.next()
print(f'M = {prng.M}')
print(f'rand = {prng.next()}')